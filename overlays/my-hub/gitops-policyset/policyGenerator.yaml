---
apiVersion: policy.open-cluster-management.io/v1
kind: PolicyGenerator
metadata:
  name: policy-generator
placementBindingDefaults:
  name: placementbinding-gitops

policyDefaults:
  standards:
    - "NIST SP 800-53"
  categories:
    - "CM Configuration Management"
  controls:
    - "CM-2 Baseline Configuration"
  namespace: yantra-rhacm-policies
  consolidateManifests: false
  remediationAction: inform
  severity: medium

policies:
- name: install-gitops-operator
  remediationAction: enforce
  disabled: false
  manifests:
    - path: operator/
      remediationAction: enforce

- name: configure-gitops-instance
  remediationAction: enforce
  disabled: false
  manifests:
    - path: instance/
      remediationAction: enforce

- name: bootstrap-appofapps
  remediationAction: enforce
  disabled: false
  manifests:
    - path: appofapps/
      remediationAction: enforce
  dependencies:
    - name: configure-gitops-instance

policySets:
- name: "gitops"
  description: "Setting up OpenShift GitOps"
  policies:
  - install-gitops-operator
  - configure-gitops-instance
  - bootstrap-appofapps
  placement:
    placementName: workload-clusters

